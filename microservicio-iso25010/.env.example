# ========================================
# CONFIGURACIÓN DE VARIABLES DE ENTORNO
# Microservicio ISO 25010
# ========================================

# ----------------------------------------
# CONFIGURACIÓN CORS
# ----------------------------------------
# URLs permitidas para acceder al API (separadas por comas)
# DESARROLLO: localhost y 127.0.0.1 con puertos comunes
# PRODUCCIÓN: Reemplazar con las URLs reales del frontend
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:4200,http://localhost:8080,http://127.0.0.1:3000,http://127.0.0.1:4200,http://127.0.0.1:8080

# Métodos HTTP permitidos (separados por comas)
CORS_ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS

# Headers permitidos en las peticiones (separados por comas)
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,Accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers

# Headers que el navegador puede leer en las respuestas (separados por comas)
CORS_EXPOSED_HEADERS=Access-Control-Allow-Origin,Access-Control-Allow-Credentials,Location,X-Total-Count

# Permitir credenciales (cookies, authorization headers)
CORS_ALLOW_CREDENTIALS=true

# Tiempo de cache para preflight requests (en segundos)
CORS_MAX_AGE=3600

# ----------------------------------------
# CONFIGURACIÓN DE BASE DE DATOS
# ----------------------------------------
# ⚠️ IMPORTANTE: CAMBIAR ESTAS CREDENCIALES ANTES DE USAR
# ⚠️ NO USAR VALORES POR DEFECTO EN PRODUCCIÓN

# URL de conexión a la base de datos
DB_URL=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE;MODE=MySQL;DATABASE_TO_LOWER=TRUE;INIT=CREATE DOMAIN IF NOT EXISTS TEXT AS VARCHAR(255)
DB_DRIVER=org.h2.Driver
DB_USERNAME=CAMBIAR_USUARIO_AQUI
DB_PASSWORD=CAMBIAR_PASSWORD_AQUI
DB_PLATFORM=org.hibernate.dialect.H2Dialect

# Configuración JPA/Hibernate
DB_DDL_AUTO=create-drop
DB_SHOW_SQL=true

# H2 Console (solo desarrollo)
H2_CONSOLE_ENABLED=true
H2_CONSOLE_PATH=/h2-console
H2_WEB_ALLOW_OTHERS=true

# ----------------------------------------
# EJEMPLOS POR AMBIENTE
# ----------------------------------------
# ⚠️ Generar credenciales seguras para cada ambiente

# DESARROLLO:
# DB_URL=jdbc:h2:mem:devdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
# DB_USERNAME=<tu-usuario-dev>
# DB_PASSWORD=<tu-password-seguro-dev>
# H2_CONSOLE_ENABLED=true
# DB_SHOW_SQL=true

# TESTING:
# DB_URL=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
# DB_USERNAME=<tu-usuario-test>
# DB_PASSWORD=<tu-password-seguro-test>
# H2_CONSOLE_ENABLED=false
# DB_SHOW_SQL=false

# PRODUCCIÓN (PostgreSQL/MySQL):
# DB_URL=jdbc:postgresql://prod-db-server:5432/iso25010_prod
# DB_DRIVER=org.postgresql.Driver
# DB_USERNAME=<tu-usuario-prod>
# DB_PASSWORD=<tu-password-seguro-prod>  # Usar gestor de secretos
# DB_PLATFORM=org.hibernate.dialect.PostgreSQLDialect
# H2_CONSOLE_ENABLED=false
# DB_DDL_AUTO=validate
# DB_SHOW_SQL=false

# ----------------------------------------
# CONFIGURACIÓN DEL SERVIDOR
# ----------------------------------------
SERVER_PORT=8080
CONTEXT_PATH=/api

# ----------------------------------------
# CONFIGURACIÓN DE LOGGING
# ----------------------------------------
LOG_LEVEL_APP=DEBUG
LOG_LEVEL_WEB=DEBUG
LOG_LEVEL_SQL=DEBUG
LOG_LEVEL_HIBERNATE=TRACE
LOG_LEVEL_ROOT=INFO

# ----------------------------------------
# SWAGGER/OpenAPI
# ----------------------------------------
SWAGGER_ENABLED=true
SWAGGER_UI_ENABLED=true
SWAGGER_API_DOCS_PATH=/api-docs
SWAGGER_UI_PATH=/swagger-ui.html

# ----------------------------------------
# JWT (AUTENTICACIÓN)
# ----------------------------------------
# ⚠️ IMPORTANTE: GENERAR UNA CLAVE SECRETA ÚNICA EN FORMATO BASE64URL
# ⚠️ Mínimo 512 bits (64 bytes)
#
# Generar con PowerShell (Windows) - Base64URL (SIN caracteres +, /, =):
#   powershell -Command "[Convert]::ToBase64String((1..64 | ForEach-Object { Get-Random -Maximum 256 })).Replace('+','-').Replace('/','_').TrimEnd('=')"
#
# Generar con OpenSSL (Linux/Mac/Git Bash) - Base64 estándar:
#   openssl rand -base64 64
#   (Nota: Si usas OpenSSL, cambia Decoders.BASE64URL a Decoders.BASE64 en JwtService.java)
#
JWT_SECRET=GENERAR_CON_COMANDO_ARRIBA_NO_USAR_ESTE_VALOR

# Tiempo de expiración del token JWT en milisegundos
# 86400000 ms = 24 horas
# 3600000 ms = 1 hora
JWT_EXPIRATION=86400000

# Tiempo de expiración del refresh token en milisegundos
# 604800000 ms = 7 días
JWT_REFRESH_TOKEN_EXPIRATION=604800000

# ----------------------------------------
# ACTUATOR (MONITOREO)
# ----------------------------------------
ACTUATOR_ENDPOINTS=health,info,metrics
ACTUATOR_HEALTH_DETAILS=when-authorized

# ----------------------------------------
# DEVTOOLS (DESARROLLO)
# ----------------------------------------
SPRING_DEVTOOLS_RESTART_ENABLED=true
SPRING_DEVTOOLS_LIVERELOAD_ENABLED=true

# ----------------------------------------
# PERFILES DE SPRING
# ----------------------------------------
# SPRING_PROFILES_ACTIVE=dev

# ========================================
# NOTAS DE CONFIGURACIÓN
# ========================================
#
# 1. SEGURIDAD CORS EN PRODUCCIÓN:
#    - Reemplazar localhost por las URLs reales del frontend
#    - Usar HTTPS en producción
#    - Ejemplo: CORS_ALLOWED_ORIGINS=https://mi-app.com,https://admin.mi-app.com
#
# 2. CONFIGURACIÓN POR AMBIENTE:
#    - Desarrollo: Usar valores por defecto de este archivo
#    - Testing: Crear .env.test con URLs de testing
#    - Producción: Configurar variables en el servidor/contenedor
#
# 3. VARIABLES DE ENTORNO:
#    - Las variables aquí definidas sobrescriben los valores por defecto en application.yml
#    - Si no se definen, se usan los valores por defecto del application.yml
#
# 4. MEJORES PRÁCTICAS:
#    - No commitear archivos .env con datos sensibles
#    - Usar gestores de secretos en producción (Azure Key Vault, AWS Secrets Manager, etc.)
#    - Validar siempre las URLs permitidas antes de desplegar
#